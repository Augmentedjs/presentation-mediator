!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("next-core-utilities"),require("presentation-view")):"function"==typeof define&&define.amd?define("presentation-mediator",["next-core-utilities","presentation-view"],t):"object"==typeof exports?exports["presentation-mediator"]=t(require("next-core-utilities"),require("presentation-view")):e["presentation-mediator"]=t(e["next-core-utilities"],e["presentation-view"])}(this,(function(e,t){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=2)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){"use strict";n.r(t),n.d(t,"Mediator",(function(){return o})),n.d(t,"Colleague",(function(){return u}));var s=n(0),i=n(1);class r extends i.View{constructor(e){super(e),e&&e.mediator?this._mediator=mediator:this._mediator=null}sendMessage(e,t){return this._mediator?this._mediator.trigger(e,t):console.warn(`sendMessage: No mediator is available for ${this.name?this.name:"-unnamed-"}, talking to myself.`),e}setMediatorMessageQueue(e){return this._setMediatorMessageQueue(e)}_setMediatorMessageQueue(e){return console.debug(`setMediatorMessageQueue: ${this.name} has a mediator? ${null!==this._mediator} and a mediator was passed? ${null!==e}`),e?(this._mediator&&this._mediator._dismissMe(this),this._mediator=e):console.warn("Regstering a mediator without passing a mediator."),e}removeMediatorMessageQueue(){return this._mediator=null,!0}get mediator(){return this._mediator}set mediator(e){return _setMediatorMessageQueue(e)}}var u=r;var o=class extends u{constructor(e){e||(e={}),e.el||(e.noEL=!0),super(e),this._defaultChannel="augmentedChannel",this._defaultIdentifier="augmentedIdentifier",this._channels={},this._colleagueMap={},this._subscriptions={}}_dismissMe(e){if(e instanceof u){const t=this._colleagueMap[e],n=this._channels[t];return this.unsubscribe(t,n.fn,e,n.identifier)}return null}delegateEvents(e){return super.delegateEvents(e),this.subscriptions={},e}undelegateEvents(e){return super.undelegateEvents(e),this.unsetSubscriptions(),e}get subscriptions(){return this._subscriptions}set subscriptions(e){if(e&&Object(s.extend)(this._subscriptions||{},e),!(e=e||this._subscriptions)||0===e.length)return;this.unsetSubscriptions(e);let t=0,n=e.length;for(t=0;t<n;t++){let n=e[t],s=!1;n.$once&&(n=n.$once,s=!0),"string"==typeof n&&(n=this[n]),this.subscribe(n.channel,n,this,s)}return e}unsetSubscriptions(e){if(!(e=e||this._subscriptions)||0===e.length)return;let t=0;const n=e.length;for(t=0;t<n;t++){let n=e[t],s=!1;n.$once&&(n=n.$once,s=!0),"string"==typeof n&&(n=this[n]),this.unsubscribe(n.channel,n.$once||n,this)}return e}observeColleague(e,t,n,s){return e instanceof u&&(n||(n=this._defaultChannel),e.setMediatorMessageQueue(this),this.subscribe(n,t,e,!1,s||this._defaultIdentifier)),s}observeColleagueAndTrigger(e,t,n){return this.observeColleague(e,(...n)=>{e.trigger(t,...n)},t,n||this._defaultIdentifier),n}dismissColleague(e,t,n,s){return e instanceof u&&(n||(n=this._defaultChannel),e.removeMediatorMessageQueue(),this.unsubscribe(n,t,e,s)),s}dismissColleagueTrigger(e,t,n){const s=n||this._defaultIdentifier;return this.dismissColleague(e,(...n)=>{e.trigger(t,...n)},t,s),n}subscribe(e,t,n,s,i){this._channels[e]||(this._channels[e]=[]);const r={fn:t,context:n||this,once:s,identifier:i||this._defaultIdentifier};return this._channels[e].push(r),this._colleagueMap[n]=e,this.on(e,this.publish,n),i}publish(e,...t){if(!e||!this._channels||!this._channels[e])return console.warn(`Mediator ${this.name}: channel ${e} doesn't exist.`),void(this._channels={});let n,s=0;const i=this._channels[e].length;for(s=0;s<i;s++)n=this._channels[e][s],n&&(n.fn&&n.fn.call(n.context,...t),n.once&&(this.unsubscribe(e,n.fn,n.context,n.identifier),s--));return e}unsubscribe(e,t,n,s){if(!this._channels[e])return;let i,r=s||this._defaultIdentifier,u=0;for(u=0;u<this._channels[e].length;u++)i=this._channels[e][u],i&&i.identifier===r&&i.context===n&&(this._channels[e].splice(u,1),u--,delete this._colleagueMap[i.context]);return e}subscribeOnce(e,t,n,s){return this.subscribe(e,t,n,!0,s),s}getColleagues(e){const t=this.getChannel(e);return t?t.context:null}get channels(){return this._channels}getChannel(e){return e||(e=this._defaultChannel),this._channels[e]?this._channels[e]:null}get defaultChannel(){return this.getChannel(this._defaultChannel)}get defaultIdentifier(){return this._defaultIdentifier}}}])}));
//# sourceMappingURL=presentation-mediator.js.map